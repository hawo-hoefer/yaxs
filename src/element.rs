#[derive(PartialEq, Eq, Debug, Clone, Copy)]
#[rustfmt::skip]
pub enum Element {
    H,  He, Li, Be, B,  C,  N,  O,  F,  Ne, Na, Mg, Al, Si, P,  S,  Cl, Ar, K,  
    Ca, Sc, Ti, V,  Cr, Mn, Fe, Co, Ni, Cu, Zn, Ga, Ge, As, Se, Br, Kr, Rb, Sr, 
    Y,  Zr, Nb, Mo, Tc, Ru, Rh, Pd, Ag, Cd, In, Sn, Sb, Te, I,  Xe, Cs, Ba, La, 
    Ce, Pr, Nd, Pm, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, Hf, Ta, W,  Re, Os, 
    Ir, Pt, Au, Hg, Tl, Pb, Bi, Po, At, Rn, Fr, Ra, Ac, Th, Pa, U,  Np, Pu, Am, 
    Cm, Bk, Cf, Es, Fm, Md, No, Lr, Rf, Db, Sg, Bh, Hs, Mt, Ds, Rg, Cn, Nh, Fl, 
    Mc, Lv, Ts, Og,
}

impl Element {
    /// return atomic number
    /// ```
    /// use yaxs::element::Element;
    ///
    /// assert_eq!(Element::H.z(), 1);
    /// assert_eq!(Element::He.z(), 2);
    /// assert_eq!(Element::Li.z(), 3);
    /// assert_eq!(Element::Db.z(), 105);
    /// ```
    pub fn z(&self) -> i32 {
        *self as i32 + 1
    }
}

impl TryFrom<&str> for Element {
    type Error = String;

    fn try_from(val: &str) -> Result<Self, Self::Error> {
        use Element::*;
        let el = match val {
            "H" => H,
            "He" => He,
            "Li" => Li,
            "Be" => Be,
            "B" => B,
            "C" => C,
            "N" => N,
            "O" => O,
            "F" => F,
            "Ne" => Ne,
            "Na" => Na,
            "Mg" => Mg,
            "Al" => Al,
            "Si" => Si,
            "P" => P,
            "S" => S,
            "Cl" => Cl,
            "Ar" => Ar,
            "K" => K,
            "Ca" => Ca,
            "Sc" => Sc,
            "Ti" => Ti,
            "V" => V,
            "Cr" => Cr,
            "Mn" => Mn,
            "Fe" => Fe,
            "Co" => Co,
            "Ni" => Ni,
            "Cu" => Cu,
            "Zn" => Zn,
            "Ga" => Ga,
            "Ge" => Ge,
            "As" => As,
            "Se" => Se,
            "Br" => Br,
            "Kr" => Kr,
            "Rb" => Rb,
            "Sr" => Sr,
            "Y" => Y,
            "Zr" => Zr,
            "Nb" => Nb,
            "Mo" => Mo,
            "Tc" => Tc,
            "Ru" => Ru,
            "Rh" => Rh,
            "Pd" => Pd,
            "Ag" => Ag,
            "Cd" => Cd,
            "In" => In,
            "Sn" => Sn,
            "Sb" => Sb,
            "Te" => Te,
            "I" => I,
            "Xe" => Xe,
            "Cs" => Cs,
            "Ba" => Ba,
            "La" => La,
            "Ce" => Ce,
            "Pr" => Pr,
            "Nd" => Nd,
            "Pm" => Pm,
            "Sm" => Sm,
            "Eu" => Eu,
            "Gd" => Gd,
            "Tb" => Tb,
            "Dy" => Dy,
            "Ho" => Ho,
            "Er" => Er,
            "Tm" => Tm,
            "Yb" => Yb,
            "Lu" => Lu,
            "Hf" => Hf,
            "Ta" => Ta,
            "W" => W,
            "Re" => Re,
            "Os" => Os,
            "Ir" => Ir,
            "Pt" => Pt,
            "Au" => Au,
            "Hg" => Hg,
            "Tl" => Tl,
            "Pb" => Pb,
            "Bi" => Bi,
            "Po" => Po,
            "At" => At,
            "Rn" => Rn,
            "Fr" => Fr,
            "Ra" => Ra,
            "Ac" => Ac,
            "Th" => Th,
            "Pa" => Pa,
            "U" => U,
            "Np" => Np,
            "Pu" => Pu,
            "Am" => Am,
            "Cm" => Cm,
            "Bk" => Bk,
            "Cf" => Cf,
            "Es" => Es,
            "Fm" => Fm,
            "Md" => Md,
            "No" => No,
            "Lr" => Lr,
            "Rf" => Rf,
            "Db" => Db,
            "Sg" => Sg,
            "Bh" => Bh,
            "Hs" => Hs,
            "Mt" => Mt,
            "Ds" => Ds,
            "Rg" => Rg,
            "Cn" => Cn,
            "Nh" => Nh,
            "Fl" => Fl,
            "Mc" => Mc,
            "Lv" => Lv,
            "Ts" => Ts,
            "Og" => Og,
            _ => return Err(format!("Invalid Element Symbol '{val}'")),
        };
        Ok(el)
    }
}

// Stolen from S.P. Ong et. al, 2013 pymatgen
// (src/pymatgen/analysis/diffraction/atomic_scattering_params.json)
#[allow(clippy::approx_constant)]
pub const fn atomic_scattering_params(el: Element) -> Option<[[f64; 2]; 4]> {
    #[rustfmt::skip]
    let ret = match el {
        Element::H  => Some([[0.202, 30.868],  [0.244, 8.544],  [0.082, 1.273], [0.0,   0.0]]),

        Element::Ru => Some([[4.358, 27.881],  [3.298, 5.179],  [1.323, 0.594], [0.0,   0.0]]),
        Element::Re => Some([[5.695, 28.968],  [4.74,  5.156],  [2.064, 0.575], [0.0,   0.0]]),
        Element::Ra => Some([[6.215, 28.382],  [5.17,  5.002],  [2.316, 0.562], [0.0,   0.0]]),
        Element::Rb => Some([[4.776, 140.782], [3.859, 18.991], [2.234, 3.701], [0.868, 0.419]]),
        Element::Rn => Some([[4.078, 38.406],  [4.978, 11.02],  [3.096, 2.355], [1.326, 0.299]]),
        Element::Rh => Some([[4.431, 27.911],  [3.343, 5.153],  [1.345, 0.592], [0.0,   0.0]]),
        Element::Be => Some([[1.25,  60.804],  [1.334, 18.591], [0.36,  3.653], [0.106, 0.416]]),
        Element::Ba => Some([[7.821, 117.657], [6.004, 18.778], [3.28,  3.263], [1.103, 0.376]]),
        Element::Bi => Some([[3.841, 50.261],  [4.679, 11.999], [3.192, 2.56],  [1.363, 0.318]]),
        Element::Bk => Some([[6.502, 28.375],  [5.478, 4.975],  [2.51,  0.561], [0.0,   0.0]]),
        Element::Br => Some([[2.166, 33.899],  [2.904, 10.497], [1.395, 2.041], [0.589, 0.307]]),
        // Element::D => Some([[0.202, 30.868], [0.244, 8.544], [0.082, 1.273], [0.0, 0.0]]),
        Element::P  => Some([[1.888, 44.876],  [2.469, 13.538], [0.805, 2.642], [0.32,  0.361]]),
        Element::Os => Some([[5.75,  28.933],  [4.773, 5.139],  [2.079, 0.573], [0.0,   0.0]]),
        Element::Ge => Some([[2.447, 55.893],  [2.702, 14.393], [1.616, 2.446], [0.601, 0.342]]),
        Element::Gd => Some([[5.225, 29.158],  [4.314, 5.259],  [1.827, 0.586], [0.0,   0.0]]),
        Element::Ga => Some([[2.321, 65.602],  [2.486, 15.458], [1.688, 2.581], [0.599, 0.351]]),
        Element::Pr => Some([[5.085, 28.588],  [4.043, 5.143],  [1.684, 0.581], [0.0,   0.0]]),
        Element::Pt => Some([[5.803, 29.016],  [4.87,  5.15],   [2.127, 0.572], [0.0,   0.0]]),
        Element::Pu => Some([[6.415, 28.836],  [5.419, 5.022],  [2.449, 0.561], [0.0,   0.0]]),
        Element::C  => Some([[0.731, 36.995],  [1.195, 11.297], [0.456, 2.814], [0.125, 0.346]]),
        Element::Pb => Some([[3.51,  52.914],  [4.552, 11.884], [3.154, 2.571], [1.359, 0.321]]),
        Element::Pa => Some([[6.306, 28.688],  [5.303, 5.026],  [2.386, 0.561], [0.0,   0.0]]),
        Element::Pd => Some([[4.436, 28.67],   [3.454, 5.269],  [1.383, 0.595], [0.0,   0.0]]),
        Element::Cd => Some([[2.574, 55.675],  [3.259, 11.838], [2.547, 2.784], [0.838, 0.322]]),
        Element::Po => Some([[6.07,  28.075],  [4.997, 4.999],  [2.232, 0.563], [0.0,   0.0]]),
        Element::Pm => Some([[5.201, 28.079],  [4.094, 5.081],  [1.719, 0.576], [0.0,   0.0]]),
        Element::Ho => Some([[5.376, 28.773],  [4.403, 5.174],  [1.884, 0.582], [0.0,   0.0]]),
        Element::Hf => Some([[5.588, 29.001],  [4.619, 5.164],  [1.997, 0.579], [0.0,   0.0]]),
        Element::Hg => Some([[2.682, 42.822],  [4.241, 9.856],  [2.755, 2.295], [1.27,  0.307]]),
        Element::He => Some([[0.091, 18.183],  [0.181, 6.212],  [0.11,  1.803], [0.036, 0.284]]),
        Element::Mg => Some([[2.268, 73.67],   [1.803, 20.175], [0.839, 3.013], [0.289, 0.405]]),
        Element::K  => Some([[3.951, 137.075], [2.545, 22.402], [1.98,  4.532], [0.482, 0.434]]),
        Element::Mn => Some([[2.747, 67.786],  [2.456, 15.674], [1.792, 3.0],   [0.498, 0.357]]),
        Element::O  => Some([[0.455, 23.78],   [0.917, 7.622],  [0.472, 2.144], [0.138, 0.296]]),
        Element::S  => Some([[1.659, 36.65],   [2.386, 11.488], [0.79,  2.469], [0.321, 0.34]]),
        Element::W  => Some([[5.709, 28.782],  [4.677, 5.084],  [2.019, 0.572], [0.0,   0.0]]),
        Element::Zn => Some([[1.942, 54.162],  [1.95,  12.518], [1.619, 2.416], [0.543, 0.33]]),
        Element::Eu => Some([[6.267, 100.298], [4.844, 16.066], [3.202, 2.98],  [1.2,   0.367]]),
        Element::Zr => Some([[4.105, 28.492],  [3.144, 5.277],  [1.229, 0.601], [0.0,   0.0]]),
        Element::Er => Some([[5.436, 28.655],  [4.437, 5.117],  [1.891, 0.577], [0.0,   0.0]]),
        Element::Ni => Some([[2.21,  58.727],  [2.134, 13.553], [1.689, 2.609], [0.524, 0.339]]),
        Element::Na => Some([[2.241, 108.004], [1.333, 24.505], [0.907, 3.391], [0.286, 0.435]]),
        Element::Nb => Some([[4.237, 27.415],  [3.105, 5.074],  [1.234, 0.593], [0.0,   0.0]]),
        Element::Nd => Some([[5.151, 28.304],  [4.075, 5.073],  [1.683, 0.571], [0.0,   0.0]]),
        Element::Ne => Some([[0.303, 17.64],   [0.72,  5.86],   [0.475, 1.762], [0.153, 0.266]]),
        Element::Np => Some([[6.323, 29.142],  [5.414, 5.096],  [2.453, 0.568], [0.0,   0.0]]),
        Element::Fr => Some([[6.201, 28.2],    [5.121, 4.954],  [2.275, 0.556], [0.0,   0.0]]),
        Element::Fe => Some([[2.544, 64.424],  [2.343, 14.88],  [1.759, 2.854], [0.506, 0.35]]),
        Element::B  => Some([[0.945, 46.444],  [1.312, 14.178], [0.419, 3.223], [0.116, 0.377]]),
        Element::F  => Some([[0.387, 20.239],  [0.811, 6.609],  [0.475, 1.931], [0.146, 0.279]]),
        Element::Sr => Some([[5.848, 104.972], [4.003, 19.367], [2.342, 3.737], [0.88,  0.414]]),
        Element::N  => Some([[0.572, 28.847],  [1.043, 9.054],  [0.465, 2.421], [0.131, 0.317]]),
        Element::Kr => Some([[2.034, 29.999],  [2.927, 9.598],  [1.342, 1.952], [0.589, 0.299]]),
        Element::Si => Some([[2.129, 57.775],  [2.533, 16.476], [0.835, 2.88],  [0.322, 0.386]]),
        Element::Sn => Some([[3.45,  59.104],  [3.735, 14.179], [2.118, 2.855], [0.877, 0.327]]),
        Element::Sm => Some([[5.255, 28.016],  [4.113, 5.037],  [1.743, 0.577], [0.0,   0.0]]),
        Element::V  => Some([[3.245, 76.379],  [2.698, 17.726], [1.86,  3.363], [0.486, 0.374]]),
        Element::Sc => Some([[3.966, 88.96],   [2.917, 20.606], [1.925, 3.856], [0.48,  0.399]]),
        Element::Sb => Some([[3.564, 50.487],  [3.844, 13.316], [2.687, 2.691], [0.864, 0.316]]),
        Element::Se => Some([[2.298, 38.83],   [2.854, 11.536], [1.456, 2.146], [0.59,  0.316]]),
        Element::Co => Some([[2.367, 61.431],  [2.236, 14.18],  [1.724, 2.725], [0.515, 0.344]]),
        Element::Cm => Some([[6.46,  28.396],  [5.469, 4.97],   [2.471, 0.554], [0.0,   0.0]]),
        Element::Cl => Some([[1.452, 30.935],  [2.292, 9.98],   [0.787, 2.234], [0.322, 0.323]]),
        Element::Ca => Some([[4.47,  99.523],  [2.971, 22.696], [1.97,  4.195], [0.482, 0.417]]),
        Element::Cf => Some([[6.548, 28.461],  [5.526, 4.965],  [2.52,  0.557], [0.0,   0.0]]),
        Element::Ce => Some([[5.007, 28.283],  [3.98,  5.183],  [1.678, 0.589], [0.0,   0.0]]),
        Element::Xe => Some([[3.366, 35.509],  [4.147, 11.117], [2.443, 2.294], [0.829, 0.289]]),
        Element::Tm => Some([[5.441, 29.149],  [4.51,  5.264],  [1.956, 0.59],  [0.0,   0.0]]),
        Element::Cs => Some([[6.062, 155.837], [5.986, 19.695], [3.303, 3.335], [1.096, 0.379]]),
        Element::Cr => Some([[2.307, 78.405],  [2.334, 15.785], [1.823, 3.157], [0.49,  0.364]]),
        Element::Cu => Some([[1.579, 62.94],   [1.82,  12.453], [1.658, 2.504], [0.532, 0.333]]),
        Element::La => Some([[4.94,  28.716],  [3.968, 5.245],  [1.663, 0.594], [0.0,   0.0]]),
        Element::Li => Some([[1.611, 107.638], [1.246, 30.48],  [0.326, 4.533], [0.099, 0.495]]),
        Element::Tl => Some([[5.932, 29.086],  [4.972, 5.126],  [2.195, 0.572], [0.0,   0.0]]),
        Element::Lu => Some([[5.553, 28.907],  [4.58,  5.16],   [1.969, 0.577], [0.0,   0.0]]),
        Element::Th => Some([[6.264, 28.651],  [5.263, 5.03],   [2.367, 0.563], [0.0,   0.0]]),
        Element::Ti => Some([[3.565, 81.982],  [2.818, 19.049], [1.893, 3.59],  [0.483, 0.386]]),
        Element::Te => Some([[4.785, 27.999],  [3.688, 5.083],  [1.5,   0.581], [0.0,   0.0]]),
        Element::Tb => Some([[5.272, 29.046],  [4.347, 5.226],  [1.844, 0.585], [0.0,   0.0]]),
        Element::Tc => Some([[4.318, 28.246],  [3.27,  5.148],  [1.287, 0.59],  [0.0,   0.0]]),
        Element::Ta => Some([[5.659, 28.807],  [4.63,  5.114],  [2.014, 0.578], [0.0,   0.0]]),
        Element::Yb => Some([[5.529, 28.927],  [4.533, 5.144],  [1.945, 0.578], [0.0,   0.0]]),
        Element::Dy => Some([[5.332, 28.888],  [4.37,  5.198],  [1.863, 0.581], [0.0,   0.0]]),
        Element::I  => Some([[3.473, 39.441],  [4.06,  11.816], [2.522, 2.415], [0.84,  0.298]]),
        Element::U  => Some([[6.767, 85.951],  [6.729, 15.642], [4.014, 2.936], [1.561, 0.335]]),
        Element::Y  => Some([[4.129, 27.548],  [3.012, 5.088],  [1.179, 0.591], [0.0,   0.0]]),
        Element::Ac => Some([[6.278, 28.323],  [5.195, 4.949],  [2.321, 0.557], [0.0,   0.0]]),
        Element::Ag => Some([[2.036, 61.497],  [3.272, 11.824], [2.511, 2.846], [0.837, 0.327]]),
        Element::Ir => Some([[5.754, 29.159],  [4.851, 5.152],  [2.096, 0.57],  [0.0,   0.0]]),
        Element::Am => Some([[6.378, 29.156],  [5.495, 5.102],  [2.495, 0.565], [0.0,   0.0]]),
        Element::Al => Some([[2.276, 72.322],  [2.428, 19.773], [0.858, 3.08],  [0.317, 0.408]]),
        Element::As => Some([[2.399, 45.718],  [2.79,  12.817], [1.529, 2.28],  [0.594, 0.328]]),
        Element::Ar => Some([[1.274, 26.682],  [2.19,  8.813],  [0.793, 2.219], [0.326, 0.307]]),
        Element::Au => Some([[2.388, 42.866],  [4.226, 9.743],  [2.689, 2.264], [1.255, 0.307]]),
        Element::At => Some([[6.133, 28.047],  [5.031, 4.957],  [2.239, 0.558], [0.0,   0.0]]),
        Element::In => Some([[3.153, 66.649],  [3.557, 14.449], [2.818, 2.976], [0.884, 0.335]]),
        Element::Mo => Some([[3.12,  72.464],  [3.906, 14.642], [2.361, 3.237], [0.85,  0.366]]),
        _ => None
    };
    ret
}
